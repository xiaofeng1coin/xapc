<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PC 控制器</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>小爱 PC 控制中心</h1>
        
        <div class="status-box">
            <button onclick="fetch('/api/on').then(alert('已发送开机指令'))">手动开机 (WOL)</button>
            <button onclick="fetch('/api/off').then(alert('已设置关机信号'))" class="danger">手动关机 (Signal)</button>
        </div>

        <form method="POST">
            <div class="form-group">
                <label>巴法云私钥 (UID):</label>
                <input type="text" name="uid" value="{{ config.bemfa_uid }}" required>
            </div>
            <div class="form-group">
                <label>巴法云主题 (Topic):</label>
                <input type="text" name="topic" value="{{ config.bemfa_topic }}" placeholder="例如 WinPC002" required>
                <small>建议以002结尾，米家会识别为插座</small>
            </div>
            <div class="form-group">
                <label>电脑 MAC 地址:</label>
                <input type="text" name="mac" value="{{ config.pc_mac }}" placeholder="AA:BB:CC:DD:EE:FF" required>
            </div>
            <button type="submit" class="save-btn">保存配置</button>
        </form>
        
        <div class="info-box">
            <p><strong>Windows 脚本配置地址:</strong><br>
            http://[你的LinuxIP]:5000/check_shutdown</p>
        </div>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="alert">{{ messages[0] }}</div>
          {% endif %}
        {% endwith %}
    </div>
</body>
</html>